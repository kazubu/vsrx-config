<?xml version="1.0"?>
<configuration operation="replace">
  <system>
    <host-name>vsrx-<%= rid %></host-name>
    <root-authentication>
      <encrypted-password>$5$pGE0h/.C$A5M6DyFdow3cyU1WrLEc3Us1e4oGX4pcNrPm1OqW5F1</encrypted-password>
    </root-authentication>
    <services>
      <ssh>
      </ssh>
    </services>
    <syslog>
      <user>
        <name>*</name>
        <contents>
          <name>any</name>
          <emergency/>
        </contents>
      </user>
      <file>
        <name>messages</name>
        <contents>
          <name>any</name>
          <any/>
        </contents>
        <contents>
          <name>authorization</name>
          <info/>
        </contents>
      </file>
      <file>
        <name>interactive-commands</name>
        <contents>
          <name>interactive-commands</name>
          <any/>
        </contents>
      </file>
    </syslog>
  </system>
  <security>
    <flow>
      <tcp-session>
        <no-syn-check/>
        <no-sequence-check/>
      </tcp-session>
    </flow>
    <policies>
      <policy>
        <from-zone-name>trust</from-zone-name>
        <to-zone-name>trust</to-zone-name>
        <policy>
          <name>default-permit</name>
          <match>
            <source-address>any</source-address>
            <destination-address>any</destination-address>
            <application>any</application>
          </match>
          <then>
            <permit>
            </permit>
          </then>
        </policy>
      </policy>
      <policy>
        <from-zone-name>trust</from-zone-name>
        <to-zone-name>untrust</to-zone-name>
        <policy>
          <name>default-permit</name>
          <match>
            <source-address>any</source-address>
            <destination-address>any</destination-address>
            <application>any</application>
          </match>
          <then>
            <permit>
            </permit>
          </then>
        </policy>
      </policy>
      <policy>
        <from-zone-name>untrust</from-zone-name>
        <to-zone-name>trust</to-zone-name>
        <policy>
          <name>default-deny</name>
          <match>
            <source-address>any</source-address>
            <destination-address>any</destination-address>
            <application>any</application>
          </match>
          <then>
            <deny/>
          </then>
        </policy>
      </policy>
    </policies>
    <zones>
      <security-zone>
        <name>trust</name>
        <interfaces>
          <name>ge-0/0/0.0</name>
          <host-inbound-traffic>
            <system-services>
              <name>ping</name>
            </system-services>
            <system-services>
              <name>ssh</name>
            </system-services>
            <system-services>
              <name>netconf</name>
            </system-services>
            <protocols>
              <name>bgp</name>
            </protocols>
          </host-inbound-traffic>
        </interfaces>
      </security-zone>
      <security-zone>
        <name>untrust</name>
        <interfaces>
          <name>ge-0/0/1.0</name>
          <host-inbound-traffic>
            <system-services>
              <name>ping</name>
            </system-services>
            <system-services>
              <name>ssh</name>
            </system-services>
            <system-services>
              <name>netconf</name>
            </system-services>
            <protocols>
              <name>bgp</name>
            </protocols>
          </host-inbound-traffic>
        </interfaces>
      </security-zone>
    </zones>
  </security>
  <interfaces>
    <interface>
      <name>ge-0/0/0</name>
      <unit>
        <name>0</name>
        <family>
          <inet>
            <address>
              <name><%= ge0_addr %>/16</name>
            </address>
          </inet>
        </family>
      </unit>
    </interface>
    <interface>
      <name>ge-0/0/1</name>
      <unit>
        <name>0</name>
        <family>
          <inet>
            <address>
              <name><%= ge1_addr %>/16</name>
            </address>
          </inet>
        </family>
      </unit>
    </interface>
    <interface>
      <name>fxp0</name>
      <unit>
        <name>0</name>
        <family>
          <inet>
            <dhcp>
            </dhcp>
          </inet>
        </family>
      </unit>
    </interface>
    <interface>
      <name>lo0</name>
      <unit>
        <name>0</name>
        <family>
          <inet>
            <address>
              <name><%= lo0_addr %>/32</name>
            </address>
          </inet>
        </family>
      </unit>
    </interface>
  </interfaces>
  <snmp>
    <community>
      <name>public</name>
    </community>
  </snmp>
  <routing-options>
    <router-id><%= lo0_addr %></router-id>
    <autonomous-system>
      <as-number><%= asn %></as-number>
    </autonomous-system>
  </routing-options>
  <protocols>
    <bgp>
      <group>
        <name>uplink</name>
        <neighbor>
          <name>10.1.255.254</name>
          <peer-as>65500</peer-as>
        </neighbor>
      </group>
      <group>
        <name>downlink</name>
        <neighbor>
          <name>10.2.255.254</name>
          <peer-as>65501</peer-as>
        </neighbor>
      </group>
    </bgp>
  </protocols>
</configuration>
